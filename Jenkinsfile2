def configuration() {
    stage('Configuration') {
        steps {
            script {
                // Ajouter des étapes de configuration communes à tous les couloirs ici
            }
        }
    }
}

def testsCommuns() {
    stage('Tests communs') {
        steps {
            script {
                // Ajouter des tests communs à tous les couloirs ici
            }
        }
    }
}

def etapesSpecifiquesPourA() {
    stage('Etapes spécifiques pour A') {
        steps {
            script {
                // Ajouter des étapes spécifiques au couloir A ici
            }
        }
    }
}

def etapesSpecifiquesPourB() {
    stage('Etapes spécifiques pour B') {
        steps {
            script {
                // Ajouter des étapes spécifiques au couloir B ici
            }
        }
    }
}

def etapesSpecifiquesPourC() {
    stage('Etapes spécifiques pour C') {
        steps {
            script {
                // Ajouter des étapes spécifiques au couloir C ici
            }
        }
    }
}

pipeline {
    agent any

    environment {
        COULOIR = params.COULOIR
    }

    stages {
        configuration()
        testsCommuns()

        script {
            // Ajouter les étapes spécifiques au couloir choisi
            switch(COULOIR) {
                case 'A':
                    etapesSpecifiquesPourA()
                    break
                case 'B':
                    etapesSpecifiquesPourB()
                    break
                case 'C':
                    etapesSpecifiquesPourC()
                    break
                default:
                    error "Couloir inconnu: ${COULOIR}"
            }
        }
    }

    post {
        failure {
            echo "Échec dans le couloir ${COULOIR}. Veuillez vérifier les rapports et logs."
        }
        success {
            echo "Les tests ont réussi dans le couloir ${COULOIR}. La construction est prête pour la validation manuelle."
        }
    }
}
